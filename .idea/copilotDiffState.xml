<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/younesbouhouche/musicplayer/core/domain/CustomMediaNotificationProvider.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/younesbouhouche/musicplayer/core/domain/CustomMediaNotificationProvider.kt" />
              <option name="originalContent" value="package younesbouhouche.musicplayer.core.domain&#10;&#10;import android.app.Notification&#10;import android.app.NotificationChannel&#10;import android.app.NotificationManager&#10;import android.content.Context&#10;import android.os.Build&#10;import androidx.core.app.NotificationCompat&#10;import androidx.media3.common.Player&#10;import androidx.media3.common.util.UnstableApi&#10;import androidx.media3.session.CommandButton&#10;import androidx.media3.session.DefaultMediaNotificationProvider&#10;import androidx.media3.session.MediaNotification&#10;import androidx.media3.session.MediaSession&#10;import com.google.common.collect.ImmutableList&#10;import younesbouhouche.musicplayer.R&#10;&#10;@UnstableApi&#10;class CustomMediaNotificationProvider(context: Context) : DefaultMediaNotificationProvider(context) {&#10;&#10;    companion object {&#10;        const val NOTIFICATION_ID = 1&#10;        const val CHANNEL_ID = &quot;music_playback_channel&quot;&#10;    }&#10;&#10;    init {&#10;        createNotificationChannel(context)&#10;    }&#10;&#10;    private fun createNotificationChannel(context: Context) {&#10;        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) {&#10;            val channel = NotificationChannel(&#10;                CHANNEL_ID,&#10;                &quot;Music Playback&quot;,&#10;                NotificationManager.IMPORTANCE_LOW&#10;            ).apply {&#10;                description = &quot;Shows currently playing music&quot;&#10;                setShowBadge(false)&#10;            }&#10;            val notificationManager = context.getSystemService(NotificationManager::class.java)&#10;            notificationManager.createNotificationChannel(channel)&#10;        }&#10;    }&#10;&#10;    fun ensureForeground(service: androidx.media3.session.MediaSessionService) {&#10;        val notification = createPlaceholderNotification(service)&#10;        service.startForeground(NOTIFICATION_ID, notification)&#10;    }&#10;&#10;    private fun createPlaceholderNotification(context: Context): Notification {&#10;        return NotificationCompat.Builder(context, CHANNEL_ID)&#10;            .setContentTitle(&quot;Music Player&quot;)&#10;            .setContentText(&quot;Loading...&quot;)&#10;            .setSmallIcon(R.drawable.media3_notification_small_icon)&#10;            .setPriority(NotificationCompat.PRIORITY_LOW)&#10;            .setOngoing(true)&#10;            .build()&#10;    }&#10;&#10;    override fun getMediaButtons(&#10;        session: MediaSession,&#10;        playerCommands: Player.Commands,&#10;        mediaButtonPreferences: ImmutableList&lt;CommandButton&gt;,&#10;        showPauseButton: Boolean&#10;    ): ImmutableList&lt;CommandButton&gt; {&#10;        val playPauseButton = mediaButtonPreferences.find { button -&gt;&#10;            button.sessionCommand == null &amp;&amp;&#10;            (button.iconResId == androidx.media3.session.R.drawable.media3_icon_play ||&#10;             button.iconResId == androidx.media3.session.R.drawable.media3_icon_pause)&#10;        }&#10;&#10;        val previousButton = mediaButtonPreferences.find { button -&gt;&#10;            button.sessionCommand == null &amp;&amp;&#10;            button.iconResId == androidx.media3.session.R.drawable.media3_icon_previous&#10;        }&#10;&#10;        val nextButton = mediaButtonPreferences.find { button -&gt;&#10;            button.sessionCommand == null &amp;&amp;&#10;            button.iconResId == androidx.media3.session.R.drawable.media3_icon_next&#10;        }&#10;&#10;        return ImmutableList.builder&lt;CommandButton&gt;().apply {&#10;            if (previousButton != null) add(previousButton)&#10;            if (playPauseButton != null) add(playPauseButton)&#10;            if (nextButton != null) add(nextButton)&#10;            add(NotificationCustomCmdButton.REWIND_10S.commandButton)&#10;            add(NotificationCustomCmdButton.FORWARD_10S.commandButton)&#10;            add(NotificationCustomCmdButton.LOOP.commandButton)&#10;        }.build()&#10;    }&#10;&#10;    override fun addNotificationActions(&#10;        mediaSession: MediaSession,&#10;        mediaButtons: ImmutableList&lt;CommandButton&gt;,&#10;        builder: NotificationCompat.Builder,&#10;        actionFactory: MediaNotification.ActionFactory,&#10;    ): IntArray {&#10;        // Simply use our getMediaButtons implementation directly&#10;        val buttons = getMediaButtons(&#10;            mediaSession,&#10;            mediaSession.player.availableCommands,&#10;            mediaButtons,&#10;            !mediaSession.player.isPlaying&#10;        )&#10;&#10;        return super.addNotificationActions(&#10;            mediaSession,&#10;            buttons,&#10;            builder,&#10;            actionFactory&#10;        )&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package younesbouhouche.musicplayer.core.domain&#10;&#10;import android.app.Notification&#10;import android.app.NotificationChannel&#10;import android.app.NotificationManager&#10;import android.content.Context&#10;import android.os.Build&#10;import androidx.core.app.NotificationCompat&#10;import androidx.media3.common.Player&#10;import androidx.media3.common.util.UnstableApi&#10;import androidx.media3.session.CommandButton&#10;import androidx.media3.session.DefaultMediaNotificationProvider&#10;import androidx.media3.session.MediaNotification&#10;import androidx.media3.session.MediaSession&#10;import com.google.common.collect.ImmutableList&#10;import younesbouhouche.musicplayer.R&#10;&#10;@UnstableApi&#10;class CustomMediaNotificationProvider(context: Context) : DefaultMediaNotificationProvider(context) {&#10;&#10;    companion object {&#10;        const val NOTIFICATION_ID = 1&#10;        const val CHANNEL_ID = &quot;music_playback_channel&quot;&#10;    }&#10;&#10;    init {&#10;        createNotificationChannel(context)&#10;    }&#10;&#10;    private fun createNotificationChannel(context: Context) {&#10;        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) {&#10;            val channel = NotificationChannel(&#10;                CHANNEL_ID,&#10;                &quot;Music Playback&quot;,&#10;                NotificationManager.IMPORTANCE_LOW&#10;            ).apply {&#10;                description = &quot;Shows currently playing music&quot;&#10;                setShowBadge(false)&#10;            }&#10;            val notificationManager = context.getSystemService(NotificationManager::class.java)&#10;            notificationManager.createNotificationChannel(channel)&#10;        }&#10;    }&#10;&#10;    fun ensureForeground(service: androidx.media3.session.MediaSessionService) {&#10;        val notification = createPlaceholderNotification(service)&#10;        service.startForeground(NOTIFICATION_ID, notification)&#10;    }&#10;&#10;    private fun createPlaceholderNotification(context: Context): Notification {&#10;        return NotificationCompat.Builder(context, CHANNEL_ID)&#10;            .setContentTitle(&quot;Music Player&quot;)&#10;            .setContentText(&quot;Loading...&quot;)&#10;            .setSmallIcon(R.drawable.media3_notification_small_icon)&#10;            .setPriority(NotificationCompat.PRIORITY_LOW)&#10;            .setOngoing(true)&#10;            .build()&#10;    }&#10;&#10;    override fun getMediaButtons(&#10;        session: MediaSession,&#10;        playerCommands: Player.Commands,&#10;        mediaButtonPreferences: ImmutableList&lt;CommandButton&gt;,&#10;        showPauseButton: Boolean&#10;    ): ImmutableList&lt;CommandButton&gt; {&#10;        val playPauseButton = mediaButtonPreferences.find { button -&gt;&#10;            button.sessionCommand == null &amp;&amp;&#10;            (button.iconResId == androidx.media3.session.R.drawable.media3_icon_play ||&#10;             button.iconResId == androidx.media3.session.R.drawable.media3_icon_pause)&#10;        }&#10;&#10;        val previousButton = mediaButtonPreferences.find { button -&gt;&#10;            button.sessionCommand == null &amp;&amp;&#10;            button.iconResId == androidx.media3.session.R.drawable.media3_icon_previous&#10;        }&#10;&#10;        val nextButton = mediaButtonPreferences.find { button -&gt;&#10;            button.sessionCommand == null &amp;&amp;&#10;            button.iconResId == androidx.media3.session.R.drawable.media3_icon_next&#10;        }&#10;&#10;        return ImmutableList.builder&lt;CommandButton&gt;().apply {&#10;            if (previousButton != null) add(previousButton)&#10;            if (playPauseButton != null) add(playPauseButton)&#10;            if (nextButton != null) add(nextButton)&#10;            add(NotificationCustomCmdButton.REWIND_10S.commandButton)&#10;            add(NotificationCustomCmdButton.FORWARD_10S.commandButton)&#10;            add(NotificationCustomCmdButton.LOOP.commandButton)&#10;        }.build()&#10;    }&#10;&#10;    override fun addNotificationActions(&#10;        mediaSession: MediaSession,&#10;        mediaButtons: ImmutableList&lt;CommandButton&gt;,&#10;        builder: NotificationCompat.Builder,&#10;        actionFactory: MediaNotification.ActionFactory,&#10;    ): IntArray {&#10;        // Simply use our getMediaButtons implementation directly&#10;        val buttons = getMediaButtons(&#10;            mediaSession,&#10;            mediaSession.player.availableCommands,&#10;            mediaButtons,&#10;            !mediaSession.player.isPlaying&#10;        )&#10;&#10;        return super.addNotificationActions(&#10;            mediaSession,&#10;            buttons,&#10;            builder,&#10;            actionFactory&#10;        )&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>